{"version":"1.143.1","results":[{"check_id":"semgrep-rules.command-injection-execsync","path":"evidence/before-fix/system.js","start":{"line":17,"col":26,"offset":531},"end":{"line":17,"col":92,"offset":597},"extra":{"message":"Command Injection vulnerability detected. User input from req.params is \nconcatenated directly into a shell command executed via execSync without \nsanitization. This allows attackers to execute arbitrary system commands.\n\nRecommendation: Never concatenate user input into shell commands. Use \nparameterized APIs or validate/sanitize input strictly.\n","metadata":{"category":"security","cwe":"CWE-78: OS Command Injection","owasp":"A03:2021 - Injection","confidence":"HIGH","vulnerability_class":"Command Injection"},"severity":"ERROR","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep-rules.ssrf-user-controlled-url","path":"evidence/before-fix/system.js","start":{"line":77,"col":9,"offset":2376},"end":{"line":95,"col":10,"offset":2866},"extra":{"message":"Server-Side Request Forgery (SSRF) vulnerability detected. User-controlled \nURL from query parameters is used directly in HTTP request without validation.\nThis allows attackers to make requests to internal services or arbitrary URLs.\n\nRecommendation: Validate and whitelist allowed URLs/domains. Never trust \nuser input for making server-side requests.\n","metadata":{"category":"security","cwe":"CWE-918: Server-Side Request Forgery (SSRF)","owasp":"A10:2021 - Server-Side Request Forgery","confidence":"HIGH","vulnerability_class":"Server-Side Request Forgery"},"severity":"ERROR","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep-rules.missing-admin-role-check","path":"evidence/before-fix/user.js","start":{"line":64,"col":10,"offset":2082},"end":{"line":72,"col":11,"offset":2384},"extra":{"message":"Broken Function Level Authorization detected. Sensitive DELETE operation \non user accounts has no role-based access control. Any authenticated user \ncan delete other users.\n\nRecommendation: Implement middleware to verify admin role before allowing \naccess to sensitive endpoints. Example: [authJwt.verifyToken, authJwt.isAdmin]\n","metadata":{"category":"security","cwe":"CWE-285: Improper Authorization","owasp":"A01:2021 - Broken Access Control","confidence":"HIGH","vulnerability_class":"Broken Function Level Authorization"},"severity":"ERROR","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep-rules.user-enumeration-different-messages","path":"evidence/before-fix/user.js","start":{"line":209,"col":25,"offset":7889},"end":{"line":209,"col":66,"offset":7930},"extra":{"message":"User enumeration vulnerability detected. The application returns different \nerror messages for valid vs invalid users (\"User was not found\" vs other errors).\nThis allows attackers to enumerate valid user accounts.\n\nRecommendation: Use generic error messages like \"Invalid credentials\" for all \nauthentication failures.\n","metadata":{"category":"security","cwe":"CWE-204: Observable Response Discrepancy","owasp":"A07:2021 - Identification and Authentication Failures","confidence":"HIGH","vulnerability_class":"Information Disclosure"},"severity":"WARNING","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep-rules.user-enumeration-different-messages","path":"evidence/before-fix/user.js","start":{"line":242,"col":21,"offset":8944},"end":{"line":242,"col":71,"offset":8994},"extra":{"message":"User enumeration vulnerability detected. The application returns different \nerror messages for valid vs invalid users (\"User was not found\" vs other errors).\nThis allows attackers to enumerate valid user accounts.\n\nRecommendation: Use generic error messages like \"Invalid credentials\" for all \nauthentication failures.\n","metadata":{"category":"security","cwe":"CWE-204: Observable Response Discrepancy","owasp":"A07:2021 - Identification and Authentication Failures","confidence":"HIGH","vulnerability_class":"Information Disclosure"},"severity":"WARNING","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep-rules.user-enumeration-different-messages","path":"evidence/before-fix/user.js","start":{"line":293,"col":21,"offset":10817},"end":{"line":293,"col":71,"offset":10867},"extra":{"message":"User enumeration vulnerability detected. The application returns different \nerror messages for valid vs invalid users (\"User was not found\" vs other errors).\nThis allows attackers to enumerate valid user accounts.\n\nRecommendation: Use generic error messages like \"Invalid credentials\" for all \nauthentication failures.\n","metadata":{"category":"security","cwe":"CWE-204: Observable Response Discrepancy","owasp":"A07:2021 - Identification and Authentication Failures","confidence":"HIGH","vulnerability_class":"Information Disclosure"},"severity":"WARNING","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"semgrep-rules.user-enumeration-different-messages","path":"evidence/before-fix/user.js","start":{"line":389,"col":20,"offset":13684},"end":{"line":389,"col":70,"offset":13734},"extra":{"message":"User enumeration vulnerability detected. The application returns different \nerror messages for valid vs invalid users (\"User was not found\" vs other errors).\nThis allows attackers to enumerate valid user accounts.\n\nRecommendation: Use generic error messages like \"Invalid credentials\" for all \nauthentication failures.\n","metadata":{"category":"security","cwe":"CWE-204: Observable Response Discrepancy","owasp":"A07:2021 - Identification and Authentication Failures","confidence":"HIGH","vulnerability_class":"Information Disclosure"},"severity":"WARNING","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}}],"errors":[],"paths":{"scanned":["evidence/before-fix/admin.js","evidence/before-fix/frontend.js","evidence/before-fix/order.js","evidence/before-fix/server.js","evidence/before-fix/system.js","evidence/before-fix/user.js"]},"time":{"rules":[],"rules_parse_time":0.0074388980865478516,"profiling_times":{"config_time":0.4295189380645752,"core_time":0.36070919036865234,"ignores_time":5.2928924560546875e-05,"total_time":0.7905216217041016},"parsing_time":{"total_time":0.0,"per_file_time":{"mean":0.0,"std_dev":0.0},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_files":[]},"scanning_time":{"total_time":0.16324996948242188,"per_file_time":{"mean":0.027208328247070312,"std_dev":0.000474313047201728},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_files":[]},"matching_time":{"total_time":0.0,"per_file_and_rule_time":{"mean":0.0,"std_dev":0.0},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_rules_on_files":[]},"tainting_time":{"total_time":0.0,"per_def_and_rule_time":{"mean":0.0,"std_dev":0.0},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_rules_on_defs":[]},"fixpoint_timeouts":[],"prefiltering":{"project_level_time":0.0,"file_level_time":0.0,"rules_with_project_prefilters_ratio":0.0,"rules_with_file_prefilters_ratio":1.0,"rules_selected_ratio":0.26666666666666666,"rules_matched_ratio":0.26666666666666666},"targets":[],"total_bytes":0,"max_memory_bytes":122555328},"engine_requested":"OSS","skipped_rules":[],"profiling_results":[]}
